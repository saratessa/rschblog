---
title: "Examining the Role of Mathematical Language in Preschoolers’ Social and Behavioral Outcomes: A Hierarchical Linear Modeling Approach"
author: "Saratessa Palos"
date: "2025-02-26"
categories: [hlm, code, analysis]
---

## Examining the Role of Mathematical Language in Preschoolers’ Social and Behavioral Outcomes: A Hierarchical Linear Modeling Approach

The present study used a sample of 558 preschool children (Mage = 57.75 months, SD = 3.71). Monthly family income ranged from \$0 to \$5539 (M = \$1508.18, SD = \$892.92). Among the sample, 44% of the children were African American, 32% were Caucasian, 12% were Hispanic, 11% were multiracial, and 1% were Asian.

-   RQ1: Does vocabulary and mathematical language predict social skills in preschoolers?

Hypothesis 1: Higher vocabulary and math language will be associated with better social skills.

-   RQ2: Does vocabulary and mathematical language predict problem behavior in preschoolers?

Hypothesis 2: Lower vocabulary and math language will be associated with higher problem behavior.

```{r}
library(lme4)     
library(haven)      
library(tidyverse)  
library(performance)
library(here)
library(ggplot2)
library(dplyr)    
library(tidyr)    
library(mice)
```

```{r}
data <- read_dta("/Users/saratessapalos/Desktop/Research/HLM Paper/project/socialskills_problembx/data/data.dta")
```

```{r}
head(data)
```

```{r}
# Select relevant variables (ONLY vocabulary, math language, social skills, and problem behavior)
data_subset <- data %>%
  select(
    id,               
    pkschlid, ppvtst_1, ppvtst_2,   
    mlasm_1, mlasm_2,     
    ssisss_1, ssisss_2,   
    ssispb_1, ssispb_2    
  )        

```

### **Reshaping the Data: Wide to Long Format**

```{r}
data_long <- data_subset %>%
  pivot_longer(
    cols = c(ppvtst_1, ppvtst_2, mlasm_1, mlasm_2, ssisss_1, ssisss_2, ssispb_1, ssispb_2),
    names_to = c(".value", "timepoint"),
    names_sep = "_"
  )
```

```{r}
data_long$timepoint <- as.numeric(data_long$timepoint)
```

### **Checking for Missing Values**

```{r}
colSums(is.na(data_long))
```

### **Handling Missing Data Using Multiple Imputation**

```{r}
# Perform multiple imputation
imputed_data <- mice(data_long, m = 5, method = "pmm", seed = 123)
```

```{r}
# Replace missing values with imputed data
data_long <- complete(imputed_data, 1)

colSums(is.na(data_long))
```

### **Centering Variables for Analysis**

```{r}
data_long <- data_long %>%
  mutate(
    ppvtst_c = scale(ppvtst, center = TRUE, scale = FALSE), 
    mlasm_c = scale(mlasm, center = TRUE, scale = FALSE),  
    ssisss_c = scale(ssisss, center = TRUE, scale = FALSE),  
    ssispb_c = scale(ssispb, center = TRUE, scale = FALSE)  
  )
```

### **Building the Null Model for Social Skills**

```{r}
# Null model for Social Skills
null_model_social <- lmer(ssisss_c ~ (1 | pkschlid), data = data_long)
summary(null_model_social)
```

### **Building the Null Model for Problem Behavior**

```{r}
# Null model for Problem Behavior
null_model_behavior <- lmer(ssispb_c ~ (1 | pkschlid), data = data_long)
summary(null_model_behavior)
```

### **Computing the Intraclass Correlation Coefficient (ICC)**

```{r}
# ICC
icc(null_model_social)
icc(null_model_behavior)
```

### **Building the Full Model for Social Skills**

```{r}
# Full Model for Social Skills
model_social <- lmer(ssisss_c ~ ppvtst_c + mlasm_c + (1 | pkschlid), 
                     data = data_long)
summary(model_social)
```

### **Building the Full Model for Problem Behavior**

```{r}
# Full Model for Problem Behavior
model_behavior <- lmer(ssispb_c ~ ppvtst_c + mlasm_c + (1 | pkschlid), 
                       data = data_long)
summary(model_behavior)
```

### **Comparing Models Using ANOVA**

```{r}
anova(null_model_social, model_social)  
anova(null_model_behavior, model_behavior)
```

### **Checking Residual Normality (Assumption Check)**

```{r}
# Check Residual Normality
qqnorm(resid(model_social))
qqline(resid(model_social))

qqnorm(resid(model_behavior))
qqline(resid(model_behavior))
```

### **Checking Homoscedasticity (Variance Consistency)**

```{r}
# Check Homoscedasticity
plot(fitted(model_social), resid(model_social))
plot(fitted(model_behavior), resid(model_behavior))
```
